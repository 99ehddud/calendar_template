<!DOCTYPE html>

<html lang="ja">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link rel="stylesheet" href="add.css" />
    <script type="text/javascript" src=""></script>
    <title>Calendar</title>
</head>

<body>
    <header>
        <p id="header_title" onclick="location.href='index.html'">Calendar</p>
        <p id="add_schedule" onclick="location.href='add.html'">+</p>
    </header>

    <aside>

    </aside>
    
    <main>
        <form method="POST" action="submit">
            <div class="box">
                <div class="title_box">
                    <p>Title</p>
                </div>
                <div class="input_box">
                    <input type="text" id="title" name="title" required>
                </div>
            </div>
            <div class="box">
                <div class="title_box">
                    <p>Start Date</p>
                </div>
                <div class="input_box">
                    <select name="start_year" id="start_year" required>
                        <script>
                            isFirst = true;
                            let today = new Date();
                            let before_thirty_year = today.getFullYear() - 30;
                            for (let a = before_thirty_year - 1; a <= before_thirty_year + 60; a++) {
                                    option = document.createElement('option');
                                    if (isFirst) {
                                        isFirst = false;
                                        option.innerText = 'YYYY';
                                    } else {
                                        option.innerText = a;
                                    }
                                    start_year.append(option);
                                }
                        </script>
                    </select>.
                    <select name="start_month" id="start_month" required>
                        <script>
                            start_year.onchange = function () {
                                input_start_year = start_year.value;
                                if (input_start_year && input_start_year != 'YYYY' && start_month.options.length == 0) {
                                    for (let b = 0; b <= 12; b++) {
                                        option = document.createElement('option');
                                        if (b != 0) {
                                            option.innerText = b;
                                        } else {
                                            option.innerText = 'MM';
                                        }
                                        start_month.append(option);
                                    }
                                }
                            }
                        </script>
                    </select>.
                    <select name="start_day" id="start_day">
                        <script>
                            start_month.onchange = function () {
                                isFirst = true;
                                input_start_month = start_month.value;
                                if (input_start_month && input_start_month != 'MM' && start_day.options.length == 0) {
                                    for (let c = 0; c <= finalday_of_Month(start_year.value, start_month.value); c++) {
                                        option = document.createElement('option');
                                        if (c != 0) {
                                            option.innerText = c; 
                                        } else {
                                            option.innerText = 'DD';
                                        }
                                        start_day.append(option);
                                    }
                                }
                            }
                        </script>
                    </select>&nbsp; &nbsp;
                    <select name="start_hour" id="start_hour" required required>
                        <script>
                            start_day.onchange = function () {
                                input_start_day = start_day.value;
                                if (input_start_day && input_start_day != 'DD' && start_hour.options.length == 0) {
                                    for (let d = -1; d < 24; d++) {
                                        option = document.createElement('option');
                                        if (d != -1) {
                                            if (d < 10) d = '0' + d;
                                            option.innerText = d;
                                        } else {
                                            option.innerText = 'HH';
                                        }
                                        start_hour.append(option);
                                    }
                                }
                            }
                        </script>
                    </select>:
                    <select name="start_minute" id="start_minute" required>
                        <script>
                            start_hour.onchange = function () {
                                input_start_hour = start_hour.value;
                                if (input_start_hour && input_start_hour != 'HH' && start_minute.options.length == 0) {
                                    for (let e = -1; e < 60; e++) {
                                        option = document.createElement('option');
                                        if (e != -1) {
                                            if (e < 10) e = '0' + e;
                                            option.innerText = e;
                                        } else {
                                            option.innerText = 'mm';
                                        }
                                        start_minute.append(option);
                                    }
                                }
                            }
                        </script>
                    </select>
                </div>
            </div>
            <div class="box">
                <div class="title_box">
                    <p>End Date</p>
                </div>
                <div class="input_box">
                    <select name="end_year" id="end_year" required>
                        <script>
                            start_minute.onchange = function () {
                                isFirst = true;
                                input_start_year = start_year.value;
                                let after_thirty_year = today.getFullYear() + 30;
                                input_start_minute = start_minute.value;
                                if (input_start_minute && input_start_minute != 'mm' && end_year.options.length == 0) {
                                    for (let f = input_start_year-1; f <= after_thirty_year; f++) {
                                        option = document.createElement('option');
                                        if (isFirst) {
                                            isFirst = false;
                                            option.innerText = 'YYYY';
                                        } else {
                                            option.innerText = f;
                                        }
                                        end_year.append(option);
                                    }
                                }
                            }
                        </script>
                    </select>.
                    <select name="end_month" id="end_month" required>
                        <script>
                            end_year.onchange = function () {
                                input_start_year = start_year.value;
                                input_start_month = Number(start_month.value);
                                input_end_year = end_year.value;
                                if (input_end_year && input_end_year != 'YYYY' && end_month.options.length == 0) {
                                    if (input_start_year == input_end_year) {
                                        isFirst = true;
                                        for (let g = input_start_month-1; g <= 12; g++) {
                                            option = document.createElement('option');
                                            if (isFirst) {
                                                isFirst = false;
                                                option.innerText = 'MM';
                                            } else {
                                                option.innerText = g;
                                            }
                                            end_month.append(option);
                                        }
                                    } else {
                                        for (let h = 0; h <= 12; h++) {
                                            option = document.createElement('option');
                                            if (h != 0) {
                                                option.innerText = h;
                                            } else {
                                                option.innerText = 'MM';
                                            }
                                            end_month.append(option);
                                        }
                                    }
                                }
                            }
                        </script>
                    </select>.
                    <select name="end_day" id="end_day">
                        <script>
                            end_month.onchange = function () {
                                input_start_year = start_year.value;
                                input_start_month = start_month.value;
                                input_start_day = Number(start_day.value);
                                input_end_year = end_year.value;
                                input_end_month = end_month.value;
                                if (input_end_month && input_end_month != 'MM' && end_day.options.length == 0) {
                                    if ((input_start_year == input_end_year) && (input_start_month == input_end_month)) {
                                        isFirst = true;
                                        for (let i = input_start_day - 1; i <= finalday_of_Month(end_year.value, end_month.value); i++) {
                                            option = document.createElement('option');
                                            if (isFirst) {
                                                isFirst = false;
                                                option.innerText = 'DD';
                                            } else {
                                                option.innerText = i;
                                            }
                                            end_day.append(option);
                                        }
                                    } else {
                                        for (let j = 0; j <= finalday_of_Month(end_year.value, end_month.value); j++) {
                                            option = document.createElement('option');
                                            if (j != 0) {
                                                option.innerText = j;
                                            } else {
                                                option.innerText = 'DD';
                                            }
                                            end_day.append(option);
                                        }
                                    }
                                }
                            }
                        </script>
                    </select>&nbsp; &nbsp;
                    <select name="end_hour" id="end_hour" required required>
                        <script>
                            end_day.onchange = function () {
                                input_start_year = start_year.value;
                                input_start_month = start_month.value;
                                input_start_day = start_day.value;
                                input_start_hour = Number(start_hour.value);
                                input_end_year = end_year.value;
                                input_end_month = end_month.value;
                                input_end_day = end_day.value;
                                if (input_end_day && input_end_day != 'DD' && end_hour.options.length == 0) {
                                    if ((input_start_year == input_end_year) && (input_start_month == input_end_month) && (input_start_day == input_end_day)) {
                                        isFirst = true;
                                        for (let k = input_start_hour - 1; k < 24; k++) {
                                            option = document.createElement('option');
                                            if (isFirst) {
                                                isFirst = false;
                                                option.innerText = 'HH';
                                            } else {
                                                if (k < 10) k = '0' + k;
                                                option.innerText = k;
                                            }
                                            end_hour.append(option);
                                        }
                                    } else {
                                        for (let l = -1; l < 24; l++) {
                                            option = document.createElement('option');
                                            if (l != -1) {
                                                if (l < 10) l = '0' + l;
                                                option.innerText = l;
                                            }  else {
                                                option.innerText = 'HH';
                                            }
                                            end_hour.append(option);
                                        }
                                    }
                                }
                            }
                        </script>
                    </select>:
                    <select name="end_minute" id="end_minute" required>
                        <script>
                            end_hour.onchange = function () {
                                input_start_year = start_year.value;
                                input_start_month = start_month.value;
                                input_start_day = start_day.value;
                                input_start_hour = start_hour.value;
                                input_start_minute = Number(start_minute.value);
                                input_end_year = end_year.value;
                                input_end_month = end_month.value;
                                input_end_day = end_day.value;
                                input_end_hour = end_hour.value;
                                if (input_end_hour && input_end_hour != 'HH' && end_minute.options.length == 0) {
                                    if ((input_start_year == input_end_year) && (input_start_month == input_end_month) && (input_start_day == input_end_day) && (input_start_hour == input_end_hour)) {
                                        isFirst = true;
                                        for (let m = input_start_minute - 1; m < 60; m++) {
                                            option = document.createElement('option');
                                            if (isFirst) {
                                                isFirst = false;
                                                option.innerText = 'mm';
                                            } else {
                                                if (m < 10) m = '0' + m;
                                                option.innerText = m;
                                            }
                                            end_minute.append(option);
                                        }
                                    } else {
                                        for (let n = -1; n < 60; n++) {
                                            option = document.createElement('option');
                                            if (n != -1) {
                                                if (n < 10) n = '0' + n;
                                                option.innerText = n;
                                            } else {
                                                option.innerText = 'mm';
                                            }
                                            end_minute.append(option);
                                        }
                                    }
                                }
                            }
                        </script>
                    </select>
                </div>
            </div>
            <div class="box">
                <div class="title_box">
                    <p>Location</p>
                </div>
                <div class="input_box">
                    <input type="text" id="location" name="location">
                </div>
            </div>
            <div class="box">
                <div class="title_box">
                    <p>Explanation</p>
                </div>
                <div class="input_box">
                    <input type="text" id="explanation" name="explanation">
                </div>
            </div>
            <div class="box">
                <div class="submit_box">
                    <input type="submit" id="confirm" value="confirm" disabled>
                    <script>
                        end_minute.onchange = function () {
                            let input_end_minute = end_minute.value;
                            if (input_end_minute != 'mm') {
                                document.getElementById('confirm').disabled = false;
                            } else {
                                document.getElementById('confirm').disabled = true;
                            }
                        }
                    </script>
                </div>
            </div>
        </form>
    </main>
    
    <footer>
    
    </footer>
    
    <script>
        let isFirst;
        let option
        let input_start_year;
        let input_start_month;
        let input_start_day;
        let input_start_hour;
        let input_start_minute;
        let input_end_year;
        let input_end_month;
        let input_end_day;
        let input_end_hour;
        let input_end_minute;

        let start_year = document.querySelector('#start_year');
        let start_month = document.querySelector('#start_month');
        let start_day = document.querySelector('#start_day');
        let start_hour = document.querySelector('#start_hour');
        let start_minute = document.querySelector('#start_minute');
        let end_year = document.querySelector('#end_year');
        let end_month = document.querySelector('#end_month');
        let end_day = document.querySelector('#end_day');
        let end_hour = document.querySelector('#end_hour');
        let end_minute = document.querySelector('#end_minute');

        function finalday_of_Month(YYYY, MM) {
            return 32 - new Date(YYYY, MM - 1, 32).getDate();
        }

        function resize(YYYY, MM) {
            let innerWidth = window.innerWidth;
            let innerHeight = window.innerHeight;

            const header = document.querySelector('header');
            const aside = document.querySelector('aside');
            const main = document.querySelector('main');
            const footer = document.querySelector('footer');

            let headerHeight = header.offsetHeight;
            let asideWidth = aside.offsetWidth;
            let footerHeight = footer.offsetHeight;
            let middleHeight = innerHeight - headerHeight - footerHeight;

            header.style.width = innerWidth + 'px';
            aside.style.height = middleHeight + 'px';
            main.style.width = (innerWidth - asideWidth) + 'px';
            main.style.height = middleHeight + 'px';
        }
        resize();
        window.onresize = function () { resize(); }
    </script>
    
</body>

</html>